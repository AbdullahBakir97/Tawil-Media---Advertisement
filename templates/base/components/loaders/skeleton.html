{% load static %}

{% comment %}
Skeleton Loading Component
Usage:
    {% include "base/components/loaders/skeleton.html" with 
        type="article"
        count=3
        animate=True %}

Types:
    - article
    - card
    - list
    - table
    - profile
{% endcomment %}

<div class="skeleton-wrapper" 
     x-data="{ loading: true }" 
     x-show="loading">
    
    {% with count|default:1 as items %}
        {% for i in items|times %}
            {% if type == "article" %}
                <!-- Article Skeleton -->
                <div class="skeleton-article animate-pulse mb-8">
                    <div class="flex items-center space-x-4 mb-4">
                        <!-- Avatar -->
                        <div class="skeleton-circle w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded-full"></div>
                        <div class="flex-1">
                            <!-- Author -->
                            <div class="skeleton-text h-4 w-1/4 bg-gray-200 dark:bg-gray-700 rounded mb-2"></div>
                            <!-- Date -->
                            <div class="skeleton-text h-3 w-1/5 bg-gray-200 dark:bg-gray-700 rounded"></div>
                        </div>
                    </div>
                    <!-- Title -->
                    <div class="skeleton-text h-6 w-3/4 bg-gray-200 dark:bg-gray-700 rounded mb-4"></div>
                    <!-- Content -->
                    <div class="space-y-3">
                        <div class="skeleton-text h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                        <div class="skeleton-text h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                        <div class="skeleton-text h-4 w-2/3 bg-gray-200 dark:bg-gray-700 rounded"></div>
                    </div>
                </div>

            {% elif type == "card" %}
                <!-- Card Skeleton -->
                <div class="skeleton-card animate-pulse bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 mb-4">
                    <!-- Image -->
                    <div class="skeleton-image h-48 bg-gray-200 dark:bg-gray-700 rounded-lg mb-4"></div>
                    <!-- Title -->
                    <div class="skeleton-text h-6 w-3/4 bg-gray-200 dark:bg-gray-700 rounded mb-3"></div>
                    <!-- Description -->
                    <div class="space-y-2">
                        <div class="skeleton-text h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                        <div class="skeleton-text h-4 w-5/6 bg-gray-200 dark:bg-gray-700 rounded"></div>
                    </div>
                    <!-- Footer -->
                    <div class="flex justify-between items-center mt-4">
                        <div class="skeleton-text h-4 w-1/4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                        <div class="skeleton-text h-4 w-1/4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                    </div>
                </div>

            {% elif type == "list" %}
                <!-- List Item Skeleton -->
                <div class="skeleton-list-item animate-pulse flex items-center space-x-4 py-3">
                    <!-- Icon or Thumbnail -->
                    <div class="skeleton-circle w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-full"></div>
                    <div class="flex-1">
                        <!-- Title -->
                        <div class="skeleton-text h-4 w-1/3 bg-gray-200 dark:bg-gray-700 rounded mb-2"></div>
                        <!-- Subtitle -->
                        <div class="skeleton-text h-3 w-1/4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                    </div>
                    <!-- Action -->
                    <div class="skeleton-text h-8 w-20 bg-gray-200 dark:bg-gray-700 rounded"></div>
                </div>

            {% elif type == "table" %}
                <!-- Table Row Skeleton -->
                <div class="skeleton-table-row animate-pulse flex items-center space-x-4 py-4 border-b dark:border-gray-700">
                    <!-- Checkbox -->
                    <div class="skeleton-circle w-4 h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                    <!-- Content -->
                    <div class="flex-1 grid grid-cols-4 gap-4">
                        <div class="skeleton-text h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                        <div class="skeleton-text h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                        <div class="skeleton-text h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                        <div class="skeleton-text h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                    </div>
                    <!-- Actions -->
                    <div class="flex space-x-2">
                        <div class="skeleton-circle w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-full"></div>
                        <div class="skeleton-circle w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-full"></div>
                    </div>
                </div>

            {% elif type == "profile" %}
                <!-- Profile Skeleton -->
                <div class="skeleton-profile animate-pulse text-center">
                    <!-- Avatar -->
                    <div class="skeleton-circle w-24 h-24 bg-gray-200 dark:bg-gray-700 rounded-full mx-auto mb-4"></div>
                    <!-- Name -->
                    <div class="skeleton-text h-6 w-48 bg-gray-200 dark:bg-gray-700 rounded mx-auto mb-2"></div>
                    <!-- Title -->
                    <div class="skeleton-text h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded mx-auto mb-4"></div>
                    <!-- Stats -->
                    <div class="flex justify-center space-x-8 mb-6">
                        {% for i in "123" %}
                            <div class="text-center">
                                <div class="skeleton-text h-5 w-12 bg-gray-200 dark:bg-gray-700 rounded mb-1"></div>
                                <div class="skeleton-text h-3 w-16 bg-gray-200 dark:bg-gray-700 rounded"></div>
                            </div>
                        {% endfor %}
                    </div>
                    <!-- Bio -->
                    <div class="space-y-2 max-w-md mx-auto">
                        <div class="skeleton-text h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                        <div class="skeleton-text h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
                        <div class="skeleton-text h-4 w-2/3 bg-gray-200 dark:bg-gray-700 rounded"></div>
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    {% endwith %}
</div>

<style>
    .skeleton-wrapper {
        --skeleton-bg: theme('colors.gray.200');
        --skeleton-shine: theme('colors.gray.100');
    }

    .dark .skeleton-wrapper {
        --skeleton-bg: theme('colors.gray.700');
        --skeleton-shine: theme('colors.gray.600');
    }

    @keyframes shimmer {
        0% {
            background-position: -1000px 0;
        }
        100% {
            background-position: 1000px 0;
        }
    }

    .skeleton-text,
    .skeleton-circle,
    .skeleton-image {
        background: linear-gradient(
            90deg,
            var(--skeleton-bg) 0%,
            var(--skeleton-shine) 50%,
            var(--skeleton-bg) 100%
        );
        background-size: 1000px 100%;
        animation: shimmer 2s infinite linear;
    }

    /* Responsive adjustments */
    @media (max-width: 640px) {
        .skeleton-article,
        .skeleton-card,
        .skeleton-profile {
            padding: 1rem;
        }
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
        .skeleton-text,
        .skeleton-circle,
        .skeleton-image {
            animation: none;
            background: var(--skeleton-bg);
        }
    }
</style>

<script>
    // Optional: Add functionality to control loading state
    window.Skeleton = {
        show(wrapper) {
            const el = document.querySelector(wrapper);
            if (el) Alpine.$data(el).loading = true;
        },
        hide(wrapper) {
            const el = document.querySelector(wrapper);
            if (el) Alpine.$data(el).loading = false;
        }
    };
</script>
